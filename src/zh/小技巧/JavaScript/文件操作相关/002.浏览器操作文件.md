---
title: 浏览器操作文件
lang: zh-CN
date: 2024-05-29 14:24:12
permalink: /Tips/JavaScript/File/002/
category:
  - JavaScript
tag:
  - Tips
---

::: normal-demo 演示

```html
<div class="container">
  <button class="btn">打开文件</button>
</div>
```

```js {6,7,9}
// const video = document.querySelector('.video')
// const modal = document.querySelector('.modal')
const btn = document.querySelector('.btn')
btn.addEventListener('click', async () => {
  // try {
    const handler = await showDirectoryPicker()
    const root = await processHandle(handler)
    console.log(root)
    // 获取文件内容
    // const file = await root.children[1].getFile()
    // const reader = new FileReader()
    // reader.onload = (e) => {
    //   console.log(e.target.value)
    // }
    // reader.readAsText(file, 'utf-8')
  // } catch (e) {
  //   // 用户拒绝站点查看文件夹内容
  //   alert('用户拒绝站点查看文件夹内容')
  // }
})
async function processHandle(handle) {
  if(handle.kind === 'file') {
    return handle
  }
  handle.children = []
  const iter = await handle.entries()
  for await (const info of iter) {
    // info [" 银河战士中文版4.sgm", { kind: 'file', name: '银河战士中文版4.sgm'} ]
    const subHandle = await processHandle(info[1])
    handle.children.push(subHandle)
  }
  return handle
}
```

```css
    * {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}
.container {
  width: 100%;
  height: 100%;
  display: flex;
}
button {
  margin: auto;
  width: 100px;
  height: 50px;
}
video {
  z-index: 1;
}
.modal {
  z-index: 2;
  position: absolute;
  margin: auto;
  background-color: #7f8c8d;
  width: 100%;
  height: 50px;
  margin: auto;
  display: flex;
}
```
:::
